<!doctype html><html><head>
<link rel=stylesheet href=/syntax.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=/fossix.css rel=stylesheet media=screen>
<title>
Fossix - SOLID principles in Golang
</title>
<script data-ad-client=ca-pub-0086577717613608 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
</head>
<body><nav class="navbar navbar-expand-lg navbar-dark bg-dark">
<a class=navbar-brand href=/>
<img src=/site-logo.png width=40 height=45 class="d-inline-block align-top" alt>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class="nav-item active">
<a class=nav-link href=/>Fossix
<span class=sr-only>(current)</span>
</a>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" id=search>
<input class="form-control mr-sm-2" type=search placeholder=Search aria-label=Search id=searchString name=searchString>
<button class="btn btn-outline-success my-2 my-sm-0" type=submit name=googleSearchName value=Search>Search</button>
</form>
</div>
</nav>
<div class=container-fluid style=margin-top:25px>
<div class=row>
<div class=col-md-2>
<div class="list-group list-group-flush">
<a href=/ class="list-group-item list-group-item-action">
Home
</a>
<a href=/categories/snippets class="list-group-item list-group-item-action">
Snippets
</a>
<a href=/categories/blogs class="list-group-item list-group-item-action">
Blogs
</a>
<a href=/categories/articles class="list-group-item list-group-item-action">
Articles
</a>
<a href=/archive/ class="list-group-item list-group-item-action">
Archive
</a>
</div>
</div>
<div class=col-md-6>
<div class="row content-title">
<h1>SOLID principles in Golang</h1>
</div>
<div class="alert alert-light">
<span class=badge>Posted on: 23 March, 2017</span>
<div class=float-right>
<span> By sab</span>
</div>
</div>
<hr>
<p>As a precursor to the common design pattern in game dev which is possibly a
follow up post. The credits for any information put up here goes to Dave Cheney
from where I have derived this material.</p>
<h2 id=what-is-solid>What is SOLID?</h2>
<p>The SOLID principles are the top five, rather important patterns usually found
the Object oriented programming languages. Ref:
<a href=https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)>Wikipedia</a></p>
<p>However the post is not intended to learn these principles, there are much
better resources elsewhere for that. Here I try to relate Go&rsquo;s inherant
adoptions of these design patterns part of the language itself. However such
enforcements are not strict, its purely based on the programmer. Go is not a
Object oriented language, rather a Object based language.</p>
<h2 id=single-responsibility-principal-srp>(S)ingle responsibility principal (SRP)</h2>
<p>By definition, there should be only one responsibility the class should
have. The cohesion is the strength of the relationship between functionality. A
entity which statisfies SRP is also highly cohesive.</p>
<blockquote>
<p>A class should have only one reason to change
&ndash; Robert C. Martin</p>
</blockquote>
<p>Incase of Go, there are no classes but this focus on single functionality is
acheivable through packages. The idea of (packge oriented
design)[https://www.goinggo.net/2017/02/package-oriented-design.html] strongly
makes sense. A package in Go insists on foundational pieces which applications
could use/reuse.</p>
<ul>
<li>It starts with a name, the list <a href=https://golang.org/pkg/>here</a> is standard
library and their names themselves are intutive and limited to the domain.</li>
<li>The names &lsquo;common&rsquo;, &lsquo;utils&rsquo;, are common code smells.</li>
<li>Go encourages the attribute to be private inside a package, and only those
that is required by the API you would want to make public by starting an
attribute with a uppercase.</li>
</ul>
<p>Also read <a href=https://www.goinggo.net/2017/02/design-philosophy-on-packaging.html>this</a>.</p>
<h2 id=openclosed-principal>(O)pen/Closed principal</h2>
<p>By definition, a class should be open for extension and closed for
modification. From wikipedia:</p>
<blockquote>
<p>A class is closed, since it may be compiled, stored in a library, baselined,
and used by client classes. But it is also open, since any new class may use
it as parent, adding new features. When a descendant class is defined, there
is no need to change the original or to disturb its clients</p>
</blockquote>
<p>In Go, Such extensions are possible without changing the original type. But
before that understand Go&rsquo;s type doesn&rsquo;t carry over methods.</p>
<pre><code class=language-go>type Animal struct {
	name string
}

func (a Animal) eat() {
	fmt.Print(&quot;eat grass!&quot;)
}

type Human Animal

func (h Human) fight() {
	fmt.Print(&quot;Fight the FUD!&quot;)
}

func main() {
	var animal Animal
	var human Human
	animal.eat()		// Prints &quot;eat grass!&quot;
	human.fight()		// Prints &quot;Fight the FUD!&quot;

	animal.fight()		// WON'T WORK!
	human.eat()		// WON'T WORK!
}
</code></pre>
<p>This is important, the types <code>Animal</code> and <code>Human</code> have same layout in the
memory, but their methods(behaviour) doesn&rsquo;t interfere with each other; But for
<code>Human</code> to extend <code>Animal</code> there is type embedding in Go.</p>
<pre><code class=language-go>type Animal struct {
	name string
}

func (a Animal) eat() string {
	return &quot;cabbage&quot;
}

type Human struct {
	Animal
	age int
}

func (h Human) drink() string {
	if h.age &gt; 18 {
		return &quot;can drink&quot;
	} else {
		return &quot;cannot drink&quot;
	}
}

func main() {
	h := Human{Animal{name: &quot;Sab&quot;}, 10}
	h.drink()
	h.eat()
	fmt.Printf(&quot;%s is %d, eats %s and %s &quot;, h.name, h.age, h.eat(), h.drink())

}
</code></pre>
<p>Above, <code>Human</code> has got both attributes & methods of <code>Animal</code>.</p>
<h2 id=liskov-substitution-principal>(L)iskov Substitution principal</h2>
<blockquote>
<p>&ldquo;objects in a program should be replaceable with instances of their subtypes
without altering the correctness of that program&rdquo;</p>
</blockquote>
<p>In Go the idea of abstract base class is acheived with interfaces, any object
can implicitly satisfy the interface by implementing the method of the
interface; I shall start with the violation, and then to the suitable example;
this example is from a project I worked on recently.</p>
<p>Each component is a induvidual entity in the game and scene represents the collection of them,</p>
<pre><code class=language-go>type interface component {
	draw()
	resize(int, int)
}

type struct Scene {
	objs []component
}

func (s Scene) draw() {
	for c := range s.objs {
		objs.draw()	// Liskovs here
	}
}

type bird struct {
	// lots of fields here
}

func (b bird) draw() {
	// Copy each field from json to d
} 

func (b bird) resize(width, height int) {
	// Resize the obj texture
}

type background struct {
	// Fields here
}
func (p background) draw() {
	// Copy each field from json to d
} 

func (p background) resize(width, height int) {
	// ... return total avaliable count
}
</code></pre>
<p>But, later when I added new levels I wanted to change the background of the game
and then went on to do this:</p>
<pre><code class=language-go>type interface component {
	draw()
	resize(int, int)
	updateTexture(*texture) // &lt;- added this one
}
</code></pre>
<p>When that change was added to the <code>component</code> interface, which wasn&rsquo;t required
by the other components since they won&rsquo;t change I am forced to make other
components be polluted with <code>updateTexture()</code> in order to satisfy the interface.</p>
<pre><code class=language-go>func (b background) updateTexture(t *texture) { // required for the background change
	// change the texture
}

func (b bird) updateTexture(t *texture) { // not required for the bird
	return
}
</code></pre>
<p>This a voilation of Liskov&rsquo;s, but the solution lies in the <code>I</code> of the <code>SOLID</code>.</p>
<h2 id=interface-segregation-principal>(I)nterface Segregation Principal</h2>
<blockquote>
<p>Clients should not be forced to depend upon interfaces that they do not use,</p>
</blockquote>
<p>In the above example of the game components; the interface is fat and polluted,
why will a Renderer system need to update a texture? Why will a Texture Manager
system need to draw? Different clients require different interfaces. We shall
split the interfaces into smaller logical pieces</p>
<pre><code class=language-go>type drawableComponent interface { // interface for drawable components
	draw()
}

type updatableComponent interface { // updatable components
	resize()
	updateTexture()
}

func draw(obj drawableComponent) {
	obj.draw()
}

func resize(obj updatableComponent) {
	obj.resize()
}

func changeTexture(obj updatableComponent) {
	fmt.Print(&quot;update texture&quot;)
}

type gameEntity struct {
}

func (g gameEntity) resize() {
	fmt.Println(&quot;resized&quot;)
}

func (g gameEntity) draw() {
	fmt.Println(&quot;draw&quot;)
}

func (g gameEntity) updateTexture() {
	fmt.Println(&quot;update Texture&quot;)
}

func main() {
	obj := gameEntity{}
	draw(obj)
	resize(obj)
	changeTexture(obj)
}
</code></pre>
<h2 id=dependency-invenrsion-principal>(D)ependency invenrsion principal</h2>
<p>Work in progress.</p>
<hr>
<div class=float-right>
<a href=https://fossix.org/tagsgo class="badge badge-dark">go</a>
<a href=https://fossix.org/tagsgolang class="badge badge-dark">golang</a>
<a href=https://fossix.org/tagsgo-design-patterns class="badge badge-dark">go-design-patterns</a>
</div>
</div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/fossix.js></script>
<script src=//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<hr>
<div class=container>
<div class=row>
<div class=mx-auto>
<ul class=nav>
<li class=nav-item>
<a class="nav-link text-muted" href=/about>About</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/contact/>Contact</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/privacy/>Privacy Policy</a>
</li>
</ul>
</div>
</div>
<div class=row>
<div class=mx-auto>
<p>Site design and logo and content &copy; fossix.org</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>