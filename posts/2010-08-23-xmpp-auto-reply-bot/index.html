<!doctype html><html><head>
<link rel=stylesheet href=/syntax.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=/fossix.css rel=stylesheet media=screen>
<title>
Fossix - XMPP Auto Reply Bot
</title>
<script data-ad-client=ca-pub-0086577717613608 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
</head>
<body><nav class="navbar navbar-expand-lg navbar-dark bg-dark">
<a class=navbar-brand href=/>
<img src=/site-logo.png width=40 height=45 class="d-inline-block align-top" alt>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class="nav-item active">
<a class=nav-link href=/>Fossix
<span class=sr-only>(current)</span>
</a>
</li>
</ul>
<form class="form-inline my-2 my-lg-0" id=search>
<input class="form-control mr-sm-2" type=search placeholder=Search aria-label=Search id=searchString name=searchString>
<button class="btn btn-outline-success my-2 my-sm-0" type=submit name=googleSearchName value=Search>Search</button>
</form>
</div>
</nav>
<div class=container-fluid style=margin-top:25px>
<div class=row>
<div class=col-md-2>
<div class="list-group list-group-flush">
<a href=/ class="list-group-item list-group-item-action">
Home
</a>
<a href=/categories/snippets class="list-group-item list-group-item-action">
Snippets
</a>
<a href=/categories/blogs class="list-group-item list-group-item-action">
Blogs
</a>
<a href=/categories/articles class="list-group-item list-group-item-action">
Articles
</a>
<a href=/archive/ class="list-group-item list-group-item-action">
Archive
</a>
</div>
</div>
<div class=col-md-6>
<div class="row content-title">
<h1>XMPP Auto Reply Bot</h1>
</div>
<div class="alert alert-light">
<span class=badge>Posted on: 23 August, 2010</span>
<div class=float-right>
<span> By sab</span>
</div>
</div>
<hr>
<p>This an introduction to a simple Perl script that replies to your XMPP buddies based on key words.</p>
<p>This is not really a great script in terms of use, but could be fun. This is not
same as auto-reply in Pidgin. This script replies to your buddies, may be you
can run it while you are away. There are few key words like ‘hi’, ‘hello’,
‘hey’, ‘why’, ‘where’, ‘what’ etc. You can add few more you like. Probably,
using this script may make your friends think that you have gone crazy, but that
doesn’t matter ;).</p>
<p>Before using this script, you should have your systems installed with
<code>IO::Socket::SSL</code> , and <code>AnyEvent::XMPP</code>. You can install it with the following
commands.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>0
</span><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>sudo cpan IO::Socket::SSL
<span class=gp>$ </span>sudo cpan AnyEvent::XMPP
</code></pre></td></tr></table>
</div>
</div><p>The following is the code for the auto-reply bot.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 0
</span><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-perl data-lang=perl><span class=ch>#!/usr/bin/perl</span>
<span class=k>use</span> <span class=nn>strict</span><span class=p>;</span>
<span class=k>use</span> <span class=nn>utf8</span><span class=p>;</span>
<span class=k>use</span> <span class=nn>AnyEvent</span><span class=p>;</span>
<span class=k>use</span> <span class=nn>AnyEvent::XMPP::Client</span><span class=p>;</span>
<span class=k>use</span> <span class=nn>AnyEvent::XMPP::IM::Message</span><span class=p>;</span>


<span class=k>my</span> <span class=nv>$uname</span> <span class=o>=</span> <span class=s>&#39;your_gmail_id&#39;</span><span class=p>;</span>    <span class=c1># or be jabber, don&#39;t forget to change $server to jabber.org</span>
<span class=k>my</span> <span class=nv>$passwd</span> <span class=o>=</span> <span class=s>&#39;your_password&#39;</span><span class=p>;</span>
<span class=k>my</span> <span class=nv>$server</span> <span class=o>=</span> <span class=s>&#34;talk.google.com&#34;</span><span class=p>;</span>
<span class=k>my</span> <span class=nv>$j</span> <span class=o>=</span> <span class=nn>AnyEvent</span><span class=o>-&gt;</span><span class=n>condvar</span><span class=p>;</span>
<span class=k>my</span> <span class=nv>$cl</span> <span class=o>=</span> <span class=nn>AnyEvent::XMPP::Client</span><span class=o>-&gt;</span><span class=k>new</span> <span class=p>(</span><span class=n>debug</span> <span class=o>=&gt;</span> <span class=mi>0</span><span class=p>);</span>
<span class=nv>$cl</span><span class=o>-&gt;</span><span class=n>add_account</span> <span class=p>(</span><span class=nv>$uname</span><span class=p>,</span><span class=nv>$passwd</span><span class=p>,</span><span class=nv>$server</span><span class=p>);</span>
<span class=nv>$cl</span><span class=o>-&gt;</span><span class=n>reg_cb</span> <span class=p>(</span>
   <span class=n>session_ready</span> <span class=o>=&gt;</span> <span class=k>sub</span> <span class=p>{</span>
    <span class=k>my</span> <span class=p>(</span><span class=nv>$cl</span><span class=p>,</span> <span class=nv>$acc</span><span class=p>)</span> <span class=o>=</span> <span class=nv>@_</span><span class=p>;</span>
    <span class=nv>$cl</span><span class=o>-&gt;</span><span class=n>set_presence</span><span class=p>(</span><span class=s>&#34;avaliable&#34;</span><span class=p>,</span><span class=s>&#34;Under reply bot\&#39;s control&#34;</span><span class=p>,</span><span class=mi>10</span><span class=p>);</span>
   <span class=p>},</span>
   <span class=n>disconnect</span> <span class=o>=&gt;</span> <span class=k>sub</span> <span class=p>{</span>
      <span class=k>my</span> <span class=p>(</span><span class=nv>$cl</span><span class=p>,</span> <span class=nv>$acc</span><span class=p>,</span> <span class=nv>$h</span><span class=p>,</span> <span class=nv>$p</span><span class=p>,</span> <span class=nv>$reas</span><span class=p>)</span> <span class=o>=</span> <span class=nv>@_</span><span class=p>;</span>
      <span class=k>print</span> <span class=s>&#34;disconnect ($h:$p): $reas\n&#34;</span><span class=p>;</span>
   <span class=p>},</span>
   <span class=n>error</span> <span class=o>=&gt;</span> <span class=k>sub</span> <span class=p>{</span>
      <span class=k>my</span> <span class=p>(</span><span class=nv>$cl</span><span class=p>,</span> <span class=nv>$acc</span><span class=p>,</span> <span class=nv>$err</span><span class=p>)</span> <span class=o>=</span> <span class=nv>@_</span><span class=p>;</span>
      <span class=k>print</span> <span class=s>&#34;ERROR: &#34;</span> <span class=o>.</span> <span class=nv>$err</span><span class=o>-&gt;</span><span class=n>string</span> <span class=o>.</span> <span class=s>&#34;\n&#34;</span><span class=p>;</span>
   <span class=p>},</span>
   <span class=n>message</span> <span class=o>=&gt;</span> <span class=k>sub</span> <span class=p>{</span>
      <span class=k>my</span> <span class=p>(</span><span class=nv>$cl</span><span class=p>,</span> <span class=nv>$acc</span><span class=p>,</span> <span class=nv>$msg</span><span class=p>)</span> <span class=o>=</span> <span class=nv>@_</span><span class=p>;</span>
    <span class=k>my</span> <span class=p>(</span><span class=nv>$u</span><span class=p>,</span><span class=nv>$r</span><span class=p>)</span> <span class=o>=</span> <span class=nb>split</span><span class=p>(</span><span class=sr>/[\._@]/</span><span class=p>,</span><span class=nv>$msg</span><span class=o>-&gt;</span><span class=n>from</span><span class=p>);</span>
     <span class=k>if</span><span class=p>(</span><span class=nv>$msg</span><span class=o>-&gt;</span><span class=n>body</span><span class=p>()</span><span class=o>=~</span><span class=sr> /^[\s]*$/</span><span class=p>){</span> <span class=k>print</span> <span class=nv>$u</span><span class=o>.</span><span class=s>&#34; is typing\n&#34;</span><span class=p>;}</span>
    <span class=k>else</span><span class=p>{</span>
        <span class=nv>$r</span> <span class=o>=</span> <span class=nv>$msg</span><span class=o>-&gt;</span><span class=n>make_reply</span><span class=p>;</span>
        <span class=k>my</span> <span class=nv>$rep</span><span class=o>=&amp;</span><span class=n>sentm</span><span class=p>(</span><span class=nv>$msg</span><span class=o>-&gt;</span><span class=n>body</span><span class=p>,</span><span class=nv>$u</span><span class=p>);</span>
        <span class=nv>$r</span><span class=o>-&gt;</span><span class=n>add_body</span><span class=p>(</span><span class=nv>$rep</span><span class=p>);</span>
        <span class=nv>$r</span><span class=o>-&gt;</span><span class=nb>send</span><span class=p>;</span>

    <span class=p>}</span>
        <span class=k>print</span> <span class=s>&#34;$u says: &#34;</span><span class=o>.</span><span class=nv>$msg</span><span class=o>-&gt;</span><span class=n>body</span><span class=p>()</span> <span class=o>.</span> <span class=s>&#34;\n&#34;</span><span class=p>;</span>
   <span class=p>}</span>
<span class=p>);</span>

<span class=c1>#you can add your own keyword&#39;s, need to improve this part!</span>
<span class=k>sub</span> <span class=nf>sentm</span><span class=p>{</span>
    <span class=k>my</span> <span class=nv>$msg</span><span class=o>=</span><span class=nb>shift</span><span class=p>;</span>
    <span class=k>my</span> <span class=nv>$u</span> <span class=o>=</span><span class=nb>shift</span><span class=p>;</span>
    <span class=k>my</span> <span class=nv>$reply</span><span class=p>;</span>
    <span class=k>if</span><span class=p>(</span><span class=nv>$msg</span><span class=o>=~</span><span class=sr>/([hH]ow)|([hH]i)|([hH]ey)|([Hh]ello)/</span><span class=p>){</span><span class=k>return</span> <span class=nv>$reply</span><span class=o>=</span><span class=s>&#34;$u, Hi.. How are you.. &#34;</span><span class=p>;}</span>
    <span class=k>if</span><span class=p>(</span><span class=nv>$msg</span><span class=o>=~</span><span class=sr>/([Ww]hat)|\?|([Ww]at)|(^did)/</span><span class=p>){</span><span class=k>return</span> <span class=nv>$reply</span><span class=o>=</span><span class=s>&#34;yes but not really $u... :) &#34;</span><span class=p>;}</span>
    <span class=k>if</span><span class=p>(</span><span class=nv>$msg</span><span class=o>=~</span><span class=sr>/([Ww]hy)|([Ww]hen)/</span><span class=p>){</span><span class=k>return</span> <span class=nv>$reply</span><span class=o>=</span><span class=s>&#34;may be in sometime $u.. :)&#34;</span><span class=p>;}</span>
    <span class=k>if</span><span class=p>(</span><span class=nv>$msg</span><span class=o>=~</span><span class=sr>/([Oo]kay)|([oO]k)/</span><span class=p>){</span><span class=k>return</span> <span class=nv>$reply</span><span class=o>=</span><span class=s>&#34;good&#34;</span><span class=p>;}</span>
    <span class=k>else</span> <span class=p>{</span><span class=k>return</span> <span class=nv>$reply</span><span class=o>=</span><span class=s>&#34;hey $u, I will alert if I meet $ENV{&#39;USER&#39;}&#34;</span><span class=p>;}</span>
<span class=p>}</span>
<span class=nv>$cl</span><span class=o>-&gt;</span><span class=n>start</span><span class=p>;</span>
<span class=nv>$j</span><span class=o>-&gt;</span><span class=nb>wait</span><span class=p>;</span>
</code></pre></td></tr></table>
</div>
</div>
<hr>
<div class=float-right>
<a href=https://fossix.org/tagsgtalk class="badge badge-dark">gtalk</a>
<a href=https://fossix.org/tagsxmpp class="badge badge-dark">xmpp</a>
<a href=https://fossix.org/tagsbot class="badge badge-dark">bot</a>
</div>
</div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/fossix.js></script>
<script src=//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<hr>
<div class=container>
<div class=row>
<div class=mx-auto>
<ul class=nav>
<li class=nav-item>
<a class="nav-link text-muted" href=/about>About</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/contact/>Contact</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/privacy/>Privacy Policy</a>
</li>
</ul>
</div>
</div>
<div class=row>
<div class=mx-auto>
<p>Site design and logo and content &copy; fossix.org</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>