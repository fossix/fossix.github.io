<!doctype html><html><head>
<link rel=stylesheet href=/syntax.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=/fossix.css rel=stylesheet media=screen>
<title>
Fossix - SOLID principles in Golang
</title>
<script data-ad-client=ca-pub-0086577717613608 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
</head>
<body><nav class="navbar navbar-expand-md navbar-dark bg-dark">
<a class=navbar-brand href=/>
<img src=/site-logo.png width=40 height=45 class="d-inline-block align-top" alt>
<span class=front-site-title>Fossix</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item>
<a href=/categories/snippets class=nav-link>
Snippets
</a>
</li>
<li class=nav-item>
<a href=/categories/blogs class=nav-link>
Blogs
</a>
</li>
<li class=nav-item>
<a href=/categories/articles class=nav-link>
Articles
</a>
</li>
<li class=nav-item>
<a class=nav-link href=/archive/>
Archive
</a>
</li>
</ul>
</div>
</nav>
<div class=container-fluid style=margin-top:25px>
<div class=row>
<div class=col-lg-3>
</div>
<div class="col-lg-6 content">
<h1>SOLID principles in Golang</h1>
<div class=alert-light>
<div class=float-left>
<span class=badge>
23 March, 2017 | sab
</span>
</div>
<div class=float-right>
<a href=https://fossix.org/tagsgo class="badge badge-light">#go</a>
<a href=https://fossix.org/tagsgolang class="badge badge-light">#golang</a>
<a href=https://fossix.org/tagsgo-design-patterns class="badge badge-light">#go-design-patterns</a>
</div>
<span class=badge> </span>
</div>
<hr>
<p>As a precursor to the common design pattern in game dev which is possibly a
follow up post. The credits for any information put up here goes to Dave Cheney
from where I have derived this material.</p>
<h2 id=what-is-solid>What is SOLID?</h2>
<p>The SOLID principles are the top five, rather important patterns usually found
the Object oriented programming languages. Ref:
<a href=https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)>Wikipedia</a></p>
<p>However the post is not intended to learn these principles, there are much
better resources elsewhere for that. Here I try to relate Go&rsquo;s inherant
adoptions of these design patterns part of the language itself. However such
enforcements are not strict, its purely based on the programmer. Go is not a
Object oriented language, rather a Object based language.</p>
<h2 id=single-responsibility-principal-srp>(S)ingle responsibility principal (SRP)</h2>
<p>By definition, there should be only one responsibility the class should
have. The cohesion is the strength of the relationship between functionality. A
entity which statisfies SRP is also highly cohesive.</p>
<blockquote>
<p>A class should have only one reason to change
&ndash; Robert C. Martin</p>
</blockquote>
<p>Incase of Go, there are no classes but this focus on single functionality is
acheivable through packages. The idea of (packge oriented
design)[https://www.goinggo.net/2017/02/package-oriented-design.html] strongly
makes sense. A package in Go insists on foundational pieces which applications
could use/reuse.</p>
<ul>
<li>It starts with a name, the list <a href=https://golang.org/pkg/>here</a> is standard
library and their names themselves are intutive and limited to the domain.</li>
<li>The names &lsquo;common&rsquo;, &lsquo;utils&rsquo;, are common code smells.</li>
<li>Go encourages the attribute to be private inside a package, and only those
that is required by the API you would want to make public by starting an
attribute with a uppercase.</li>
</ul>
<p>Also read <a href=https://www.goinggo.net/2017/02/design-philosophy-on-packaging.html>this</a>.</p>
<h2 id=openclosed-principal>(O)pen/Closed principal</h2>
<p>By definition, a class should be open for extension and closed for
modification. From wikipedia:</p>
<blockquote>
<p>A class is closed, since it may be compiled, stored in a library, baselined,
and used by client classes. But it is also open, since any new class may use
it as parent, adding new features. When a descendant class is defined, there
is no need to change the original or to disturb its clients</p>
</blockquote>
<p>In Go, Such extensions are possible without changing the original type. But
before that understand Go&rsquo;s type doesn&rsquo;t carry over methods.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>Animal</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>name</span> <span class=kt>string</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>Animal</span><span class=p>)</span> <span class=nf>eat</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;eat grass!&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>Human</span> <span class=nx>Animal</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=nx>Human</span><span class=p>)</span> <span class=nf>fight</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;Fight the FUD!&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=kd>var</span> <span class=nx>animal</span> <span class=nx>Animal</span>
	<span class=kd>var</span> <span class=nx>human</span> <span class=nx>Human</span>
	<span class=nx>animal</span><span class=p>.</span><span class=nf>eat</span><span class=p>()</span>		<span class=c1>// Prints &#34;eat grass!&#34;
</span><span class=c1></span>	<span class=nx>human</span><span class=p>.</span><span class=nf>fight</span><span class=p>()</span>		<span class=c1>// Prints &#34;Fight the FUD!&#34;
</span><span class=c1></span>
	<span class=nx>animal</span><span class=p>.</span><span class=nf>fight</span><span class=p>()</span>		<span class=c1>// WON&#39;T WORK!
</span><span class=c1></span>	<span class=nx>human</span><span class=p>.</span><span class=nf>eat</span><span class=p>()</span>		<span class=c1>// WON&#39;T WORK!
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>This is important, the types <code>Animal</code> and <code>Human</code> have same layout in the
memory, but their methods(behaviour) doesn&rsquo;t interfere with each other; But for
<code>Human</code> to extend <code>Animal</code> there is type embedding in Go.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>Animal</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>name</span> <span class=kt>string</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>Animal</span><span class=p>)</span> <span class=nf>eat</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
	<span class=k>return</span> <span class=s>&#34;cabbage&#34;</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>Human</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>Animal</span>
	<span class=nx>age</span> <span class=kt>int</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=nx>Human</span><span class=p>)</span> <span class=nf>drink</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
	<span class=k>if</span> <span class=nx>h</span><span class=p>.</span><span class=nx>age</span> <span class=p>&gt;</span> <span class=mi>18</span> <span class=p>{</span>
		<span class=k>return</span> <span class=s>&#34;can drink&#34;</span>
	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
		<span class=k>return</span> <span class=s>&#34;cannot drink&#34;</span>
	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>h</span> <span class=o>:=</span> <span class=nx>Human</span><span class=p>{</span><span class=nx>Animal</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;Sab&#34;</span><span class=p>},</span> <span class=mi>10</span><span class=p>}</span>
	<span class=nx>h</span><span class=p>.</span><span class=nf>drink</span><span class=p>()</span>
	<span class=nx>h</span><span class=p>.</span><span class=nf>eat</span><span class=p>()</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s is %d, eats %s and %s &#34;</span><span class=p>,</span> <span class=nx>h</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=nx>h</span><span class=p>.</span><span class=nx>age</span><span class=p>,</span> <span class=nx>h</span><span class=p>.</span><span class=nf>eat</span><span class=p>(),</span> <span class=nx>h</span><span class=p>.</span><span class=nf>drink</span><span class=p>())</span>

<span class=p>}</span>
</code></pre></div><p>Above, <code>Human</code> has got both attributes & methods of <code>Animal</code>.</p>
<h2 id=liskov-substitution-principal>(L)iskov Substitution principal</h2>
<blockquote>
<p>&ldquo;objects in a program should be replaceable with instances of their subtypes
without altering the correctness of that program&rdquo;</p>
</blockquote>
<p>In Go the idea of abstract base class is acheived with interfaces, any object
can implicitly satisfy the interface by implementing the method of the
interface; I shall start with the violation, and then to the suitable example;
this example is from a project I worked on recently.</p>
<p>Each component is a induvidual entity in the game and scene represents the collection of them,</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=kd>interface</span> <span class=nx>component</span> <span class=p>{</span>
	<span class=nf>draw</span><span class=p>()</span>
	<span class=nf>resize</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=kd>struct</span> <span class=nx>Scene</span> <span class=p>{</span>
	<span class=nx>objs</span> <span class=p>[]</span><span class=nx>component</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>Scene</span><span class=p>)</span> <span class=nf>draw</span><span class=p>()</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>c</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>s</span><span class=p>.</span><span class=nx>objs</span> <span class=p>{</span>
		<span class=nx>objs</span><span class=p>.</span><span class=nf>draw</span><span class=p>()</span>	<span class=c1>// Liskovs here
</span><span class=c1></span>	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>bird</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=c1>// lots of fields here
</span><span class=c1></span><span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=nx>bird</span><span class=p>)</span> <span class=nf>draw</span><span class=p>()</span> <span class=p>{</span>
	<span class=c1>// Copy each field from json to d
</span><span class=c1></span><span class=p>}</span> 

<span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=nx>bird</span><span class=p>)</span> <span class=nf>resize</span><span class=p>(</span><span class=nx>width</span><span class=p>,</span> <span class=nx>height</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
	<span class=c1>// Resize the obj texture
</span><span class=c1></span><span class=p>}</span>

<span class=kd>type</span> <span class=nx>background</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=c1>// Fields here
</span><span class=c1></span><span class=p>}</span>
<span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>background</span><span class=p>)</span> <span class=nf>draw</span><span class=p>()</span> <span class=p>{</span>
	<span class=c1>// Copy each field from json to d
</span><span class=c1></span><span class=p>}</span> 

<span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>background</span><span class=p>)</span> <span class=nf>resize</span><span class=p>(</span><span class=nx>width</span><span class=p>,</span> <span class=nx>height</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
	<span class=c1>// ... return total avaliable count
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>But, later when I added new levels I wanted to change the background of the game
and then went on to do this:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=kd>interface</span> <span class=nx>component</span> <span class=p>{</span>
	<span class=nf>draw</span><span class=p>()</span>
	<span class=nf>resize</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>)</span>
	<span class=nf>updateTexture</span><span class=p>(</span><span class=o>*</span><span class=nx>texture</span><span class=p>)</span> <span class=c1>// &lt;- added this one
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>When that change was added to the <code>component</code> interface, which wasn&rsquo;t required
by the other components since they won&rsquo;t change I am forced to make other
components be polluted with <code>updateTexture()</code> in order to satisfy the interface.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=nx>background</span><span class=p>)</span> <span class=nf>updateTexture</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>texture</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// required for the background change
</span><span class=c1></span>	<span class=c1>// change the texture
</span><span class=c1></span><span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=nx>bird</span><span class=p>)</span> <span class=nf>updateTexture</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>texture</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// not required for the bird
</span><span class=c1></span>	<span class=k>return</span>
<span class=p>}</span>
</code></pre></div><p>This a voilation of Liskov&rsquo;s, but the solution lies in the <code>I</code> of the <code>SOLID</code>.</p>
<h2 id=interface-segregation-principal>(I)nterface Segregation Principal</h2>
<blockquote>
<p>Clients should not be forced to depend upon interfaces that they do not use,</p>
</blockquote>
<p>In the above example of the game components; the interface is fat and polluted,
why will a Renderer system need to update a texture? Why will a Texture Manager
system need to draw? Different clients require different interfaces. We shall
split the interfaces into smaller logical pieces</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>drawableComponent</span> <span class=kd>interface</span> <span class=p>{</span> <span class=c1>// interface for drawable components
</span><span class=c1></span>	<span class=nf>draw</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>updatableComponent</span> <span class=kd>interface</span> <span class=p>{</span> <span class=c1>// updatable components
</span><span class=c1></span>	<span class=nf>resize</span><span class=p>()</span>
	<span class=nf>updateTexture</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>draw</span><span class=p>(</span><span class=nx>obj</span> <span class=nx>drawableComponent</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>obj</span><span class=p>.</span><span class=nf>draw</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>resize</span><span class=p>(</span><span class=nx>obj</span> <span class=nx>updatableComponent</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>obj</span><span class=p>.</span><span class=nf>resize</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>changeTexture</span><span class=p>(</span><span class=nx>obj</span> <span class=nx>updatableComponent</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;update texture&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span> <span class=nx>gameEntity</span> <span class=kd>struct</span> <span class=p>{</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>gameEntity</span><span class=p>)</span> <span class=nf>resize</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;resized&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>gameEntity</span><span class=p>)</span> <span class=nf>draw</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;draw&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=p>(</span><span class=nx>g</span> <span class=nx>gameEntity</span><span class=p>)</span> <span class=nf>updateTexture</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;update Texture&#34;</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>obj</span> <span class=o>:=</span> <span class=nx>gameEntity</span><span class=p>{}</span>
	<span class=nf>draw</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span>
	<span class=nf>resize</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span>
	<span class=nf>changeTexture</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><h2 id=dependency-invenrsion-principal>(D)ependency invenrsion principal</h2>
<p>Work in progress.</p>
<hr>
</div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/fossix.js></script>
<script src=//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<hr>
<div class=container>
<div class=row>
<div class=mx-auto>
<ul class=nav>
<li class=nav-item>
<a class="nav-link text-muted" href=/about>About</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/contact/>Contact</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/privacy/>Privacy Policy</a>
</li>
</ul>
</div>
</div>
<div class=row>
<div class=mx-auto>
<p>Site design and logo and content &copy; fossix.org</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>