<!doctype html><html><head>
<link rel=stylesheet href=/syntax.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=/fossix.css rel=stylesheet media=screen>
<title>
Fossix - In-house Audio Streaming
</title>
<script data-ad-client=ca-pub-0086577717613608 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
</head>
<body><nav class="navbar navbar-expand-md navbar-dark bg-dark">
<a class=navbar-brand href=/>
<img src=/site-logo.png width=40 height=45 class="d-inline-block align-top" alt>
<span class=front-site-title>Fossix</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item>
<a href=/categories/snippets class=nav-link>
Snippets
</a>
</li>
<li class=nav-item>
<a href=/categories/blogs class=nav-link>
Blogs
</a>
</li>
<li class=nav-item>
<a href=/categories/articles class=nav-link>
Articles
</a>
</li>
<li class=nav-item>
<a class=nav-link href=/archive/>
Archive
</a>
</li>
</ul>
</div>
</nav>
<div class=container-fluid style=margin-top:25px>
<div class=row>
<div class=col-lg-3>
</div>
<div class="col-lg-6 content">
<h1>In-house Audio Streaming</h1>
<div class=alert-light>
<div class=float-left>
<span class=badge>
23 March, 2017 | santosh
</span>
</div>
<div class=float-right>
<a href=https://fossix.org/tagsandroid class="badge badge-light">#android</a>
<a href=https://fossix.org/tagsstreaming class="badge badge-light">#streaming</a>
<a href=https://fossix.org/tagsfedora class="badge badge-light">#fedora</a>
<a href=https://fossix.org/tagsaudio class="badge badge-light">#audio</a>
</div>
<span class=badge> </span>
</div>
<hr>
<p>Lots of users have gigabytes of music in their personal computer, but every time
when we want to listen to music on our portable device, we need to copy
selectively some songs to the device and then listen. You can listen to all the
songs from your PC itself. But what if your girl friend wants to watch videos
and you have only one computer in your house? Now stop fighting, leave the
computer with you girl friend and start your music stream to connect from your
Android or any mobile with streaming audio playback support.</p>
<p>How is that is what we will be looking in this post, it is quite simple, read
on.</p>
<p>I am using a Fedora, which is a RPM based ditro, so I will use yum to install
and update my packages. If you are using some other distribution based on
Debian, then you will be using aptitude.</p>
<p>The first package we need is icecast, which is a streaming media server.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>sudo yum install icecast
</code></pre></div><p><code>icecast</code> works on mount points. A mount point is where the source (which does
the actual music conversion, decoding and encoding) send all the music to. We
will do a basic, working configuration and test it.</p>
<p>The configuration for icecast is XML based. The default configuration given by
icecast is good enough, except for adding an extra listen socket with your local
IP.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;listen-socket&gt;</span>
        <span class=nt>&lt;port&gt;</span>8000<span class=nt>&lt;/port&gt;</span>
        <span class=nt>&lt;bind-address&gt;</span>192.168.1.2<span class=nt>&lt;/bind-address&gt;</span>
<span class=nt>&lt;/listen-socket&gt;</span>
</code></pre></div><p>Change the IP above to you computer’s IP, so you connect from another system or
device.</p>
<p>Now for the next package called ezstream.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>sudo yum install ezstream
</code></pre></div><p>Examples for ezstream configuration is located in <code>/usr/share/doc/ezstream/examples/</code></p>
<p>Copy the example configuration file which says ezstream_mp3.xml to some nice
folder (your home or Music folder will be fine). Before changing any
configurations for ezstream, it would be better if had tested icecast, Now copy
some mp3 file to <code>/usr/share/icecast/web</code> directory and start the icecast
server.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>icecast -b -c /etc/icecast.xml
</code></pre></div><p>the option <code>-b</code> tells icecast to run in the background and <code>-c</code> is used to pass
the config file to icecast. Now, from your browser open the URL like (of course,
change the IP to your IP, or use localhost if on the same system)</p>
<pre tabindex=0><code>http://192.168.1.2:8000/example.mp3
</code></pre><p>Now, your browser should be able to playback the streamed audio file. If this is
not working check for the log file in <code>/var/log/icecast</code> else leave a comment, we
can try to figure out the issue.</p>
<p>Ok, moving on to ezstream configuration, the default is good enough, just make
sure that the username and password for source matches that of the same in
icecast configuration file. Also check the mount point, IP and URL.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;ezstream&gt;</span>
    <span class=nt>&lt;url&gt;</span>http://localhost:8000/stream<span class=nt>&lt;/url&gt;</span>
    <span class=nt>&lt;sourcepassword&gt;</span>hackme<span class=nt>&lt;/sourcepassword&gt;</span>
    <span class=nt>&lt;format&gt;</span>MP3<span class=nt>&lt;/format&gt;</span>
    <span class=nt>&lt;filename&gt;</span>playlist.m3u<span class=nt>&lt;/filename&gt;</span>
    <span class=c>&lt;!-- Once done streaming playlist.m3u, exit: --&gt;</span>
    <span class=nt>&lt;stream_once&gt;</span>1<span class=nt>&lt;/stream_once&gt;</span>
</code></pre></div><p>You can see the playlist.m3u, that’s what we need to create now. Assuming we are
in a folder which has audio files organised by folders, we will create the m3u
files using find.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>find . -name <span class=s2>&#34;*.mp3&#34;</span> &gt; playlist.m3u
</code></pre></div><p>The final thing is to start streaming.</p>
<pre tabindex=0><code>$ ezstream -c ezstream_mp3.xml
</code></pre><p>This should start streaming your music, and you should able to listen through
your browser or players like <code>Rhythmbox</code> or <code>Totem</code>.</p>
<p>Where does Android come here?</p>
<p>Android is not required, you just need any phone with Wifi and a stream media
playback capable player. If you are using Android, then install &ldquo;Stream media
Player&rdquo;, open it, click on internet radio, give your URL as</p>
<pre tabindex=0><code>http://192.168.1.2:8000/stream
</code></pre><p>where stream is the mount point you defined in the icecast and ezstream
configuration files. Now you don’t have to be with the PC to listen to your
songs, all you require is extended wifi range, so you can sit in your garden and
relax, without keeping you PC speakers in full volume and scaring the hell out
of your neighbours.</p>
<hr>
</div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/fossix.js></script>
<script src=//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<hr>
<div class=container>
<div class=row>
<div class=mx-auto>
<ul class=nav>
<li class=nav-item>
<a class="nav-link text-muted" href=/about>About</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/contact/>Contact</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/privacy/>Privacy Policy</a>
</li>
</ul>
</div>
</div>
<div class=row>
<div class=mx-auto>
<p>Site design and logo and content &copy; fossix.org</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>