<!doctype html><html><head>
<link rel=stylesheet href=/syntax.css>
<link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous>
<link href=/fossix.css rel=stylesheet media=screen>
<title>
Fossix - Program Compilation - An introduction
</title>
<script data-ad-client=ca-pub-0086577717613608 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
</head>
<body><nav class="navbar navbar-expand-md navbar-dark bg-dark">
<a class=navbar-brand href=/>
<img src=/site-logo.png width=40 height=45 class="d-inline-block align-top" alt>
<span class=front-site-title>Fossix</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item>
<a href=/categories/snippets class=nav-link>
Snippets
</a>
</li>
<li class=nav-item>
<a href=/categories/blogs class=nav-link>
Blogs
</a>
</li>
<li class=nav-item>
<a href=/categories/articles class=nav-link>
Articles
</a>
</li>
<li class=nav-item>
<a class=nav-link href=/archive/>
Archive
</a>
</li>
</ul>
</div>
</nav>
<div class=container-fluid style=margin-top:25px>
<div class=row>
<div class=col-lg-3>
</div>
<div class="col-lg-6 content">
<h1>Program Compilation - An introduction</h1>
<div class=alert-light>
<div class=float-left>
<span class=badge>
21 July, 2013 | santosh
</span>
</div>
<div class=float-right>
<a href=https://fossix.org/tagsc class="badge badge-light">#c</a>
<a href=https://fossix.org/tagsgcc class="badge badge-light">#gcc</a>
<a href=https://fossix.org/tagslinking class="badge badge-light">#linking</a>
</div>
<span class=badge> </span>
</div>
<hr>
<p>As we already know the compilation process involves four steps,</p>
<ul>
<li>Pre-processing the source file</li>
<li>Compiling the source file to assembly</li>
<li>The assembly code is assembled to the object code</li>
<li>Linking the object code with libraries</li>
</ul>
<p>So the actual compilation process goes like the following:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>gcc -E prog.c &gt; prog.i <span class=c1># pre-process</span>
<span class=gp>$ </span>gcc -s prog.i      <span class=c1># assemble</span>
<span class=gp>$ </span>as -o prog.o prog.s    <span class=c1># compile</span>
<span class=gp>$ </span>ld -dynamic-linker /lib64/ld-linux-x86-64.so.2 <span class=se>\
</span><span class=se></span><span class=go>  /usr/lib64/crt1.o \
</span><span class=go>  /usr/lib64/crti.o \
</span><span class=go>  /usr/lib64/crtn.o -lc prog.o  # link
</span></code></pre></div><p>We will cover each of the process in detail in later sections, but the linker
stage is our focus right now.</p>
<p>The options to <code>ld</code> specify that our object code should be dynamically linked
and the dynamic linker to be used is <code>ld-linux-x86-64.so</code>. The rest of the
object files are C run time code that gets compiled into the object code. This
is where the <code>_start</code> comes into out object file. Every C program has a start up
code compiled in unless you explicitly say not to link start up code to the
compiler. Details about the C run time routines will be given in later in this
article.</p>
<p>The job of the linker is to resolve external references present in the program
and appropriately map them to the libraries and other object files. In case of
static linking the object code present in the libraries that are referenced by
the program are directly linked into the program executable. This makes the
program load faster but the size of the binary is increased. During the loading
of the program, the kernel only needs to relocate the image to its new address
by just adding the memory offset with the addresses present in the binary.</p>
<p>Static linking poses a bigger problem when many programs in the system are used
the same set of code from the libraries. The combined memory of the duplicated
code can impact the available memory considerably. Also when code present in a
library is updated, the entire program needs to be re-linked. This is a problem
for vendors as the entire binary needs to be packed and shipped.</p>
<p>To overcome this dynamic linking was conceived. Here, when the program linking
happens, the undefined references found in the program are searched in library
files and only a reference to the symbol is placed in the binary. This means,
none of the code in the external libraries are in the binary. Since the
references are not loaded into the binary, relocation cannot be performed until
the load time.</p>
<hr>
</div><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/fossix.js></script>
<script src=//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script>
<hr>
<div class=container>
<div class=row>
<div class=mx-auto>
<ul class=nav>
<li class=nav-item>
<a class="nav-link text-muted" href=/about>About</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/contact/>Contact</a>
</li>
<li class=nav-item>
<a class="nav-link text-muted" href=/privacy/>Privacy Policy</a>
</li>
</ul>
</div>
</div>
<div class=row>
<div class=mx-auto>
<p>Site design and logo and content &copy; fossix.org</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>